<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Web audio api test</title>
      <script   src="https://code.jquery.com/jquery-3.1.0.min.js"   integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s="   crossorigin="anonymous"></script> 
  </head>
  <body>

<script>
    $( function() {
        // Set up our Audio Context
      var context = new AudioContext();
      window.context = context;

      // this is where our oscillator will live
     

      // numbers we'll need later
      var width   = $(window).width();
      var height  = $(window).height();
      var xValue  = 0;
      var yValue  = 0;
      var pitch=2000;    
      var  direction='up';
    var oscillator;
        
        // recalculate the width and height if the window size changes
      $(window).resize( function() {
        width   = $(this).width();
        height  = $(this).height();
      });
        
        console.log('ping');
        
         $(document).on('mousedown', function(e) {
         
       /* if(oscillator){
            oscillator.stop();
        }*/
             
        if(direction=="up"){
            pitch=pitch/1.618;
        }  else {
            pitch=pitch*1.618;
        }    
             
        if(pitch>2000){
            direction="up";   
        } else if(pitch<60){
            direction="down";
        }    
             
        if(oscillator){    
            oscillator.frequency.value = pitch;
        } else {    
        // create the oscillator
        oscillator = context.createOscillator();
        // set the type of the oscillator
        oscillator.type = 'triangle'; // sine, triangle, sawtooth
        // set the frequency based on our stored values
        oscillator.frequency.value = pitch;
        // connect it to the output
        oscillator.connect(context.destination);
        // start the note
        oscillator.start();
        //oscillator.stop(.2);
        }  
            
      });

});

// mtof = Midi note to Frequency
// input: 0 - 127 (although you could go higher if you wanted)
// output: frequency in Hz from ~8Hz to ~12543Hz
function mtof(note) {
  return 240.0;
}
        
        </script>
  </body>
</html>

